// Generated by purs version 0.15.10
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Apply from "../Control.Apply/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Enum from "../Data.Enum/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Exists from "../Data.Exists/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_List from "../Data.List/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Newtype from "../Data.Newtype/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as ExitCodes from "../ExitCodes/index.js";
import * as Node_Encoding from "../Node.Encoding/index.js";
import * as Node_Process from "../Node.Process/index.js";
import * as Node_Stream from "../Node.Stream/index.js";
import * as Options_Applicative_BashCompletion from "../Options.Applicative.BashCompletion/index.js";
import * as Options_Applicative_Builder from "../Options.Applicative.Builder/index.js";
import * as Options_Applicative_Builder_Internal from "../Options.Applicative.Builder.Internal/index.js";
import * as Options_Applicative_Common from "../Options.Applicative.Common/index.js";
import * as Options_Applicative_Help_Chunk from "../Options.Applicative.Help.Chunk/index.js";
import * as Options_Applicative_Help_Core from "../Options.Applicative.Help.Core/index.js";
import * as Options_Applicative_Help_Levenshtein from "../Options.Applicative.Help.Levenshtein/index.js";
import * as Options_Applicative_Help_Types from "../Options.Applicative.Help.Types/index.js";
import * as Options_Applicative_Internal from "../Options.Applicative.Internal/index.js";
import * as Options_Applicative_Internal_Utils from "../Options.Applicative.Internal.Utils/index.js";
import * as Options_Applicative_Types from "../Options.Applicative.Types/index.js";
import * as Text_PrettyPrint_Leijen from "../Text.PrettyPrint.Leijen/index.js";
var un = /* #__PURE__ */ Data_Newtype.un();
var mempty = /* #__PURE__ */ Data_Monoid.mempty(Options_Applicative_Help_Types.parserHelpMonoid);
var pure = /* #__PURE__ */ Control_Applicative.pure(Options_Applicative_Help_Chunk.chunkApplicative);
var unWords = /* #__PURE__ */ Options_Applicative_Internal_Utils.unWords(Data_Foldable.foldableArray);
var append = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var map = /* #__PURE__ */ Data_Functor.map(Options_Applicative_Help_Chunk.chunkFunctor);
var map1 = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var fold = /* #__PURE__ */ Data_Array.fold(Data_Monoid.monoidArray);
var editDistance = /* #__PURE__ */ Options_Applicative_Help_Levenshtein.editDistance(Data_Eq.eqChar);
var apply = /* #__PURE__ */ Control_Apply.apply(Options_Applicative_Help_Chunk.chunkApply);
var mempty1 = /* #__PURE__ */ Data_Monoid.mempty(/* #__PURE__ */ Options_Applicative_Help_Chunk.chunkMonoid(Text_PrettyPrint_Leijen.docSemigroup));
var fold1 = /* #__PURE__ */ Data_Array.fold(Options_Applicative_Help_Types.parserHelpMonoid);
var append2 = /* #__PURE__ */ Data_Semigroup.append(Options_Applicative_Builder_Internal.modSemigroup);
var metavar = /* #__PURE__ */ Options_Applicative_Builder.metavar(Options_Applicative_Builder_Internal.commandFieldsHasMetavar);
var over = /* #__PURE__ */ Data_Newtype.over()();
var apApplyFlipped = /* #__PURE__ */ Options_Applicative_Internal_Utils.apApplyFlipped(Options_Applicative_Types.parserApply);
var map2 = /* #__PURE__ */ Data_Functor.map(Data_Maybe.functorMaybe);
var mapFlipped = /* #__PURE__ */ Data_Functor.mapFlipped(Effect.functorEffect);
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var fromEnum = /* #__PURE__ */ Data_Enum.fromEnum(ExitCodes.boundedEnumExitCode);
var pure1 = /* #__PURE__ */ Control_Applicative.pure(Effect.applicativeEffect);
var bind1 = /* #__PURE__ */ Control_Bind.bind(Effect.bindEffect);
var $$void = /* #__PURE__ */ Data_Functor["void"](Effect.functorEffect);
var mempty2 = /* #__PURE__ */ Data_Monoid.mempty(/* #__PURE__ */ Data_Monoid.monoidFn(/* #__PURE__ */ Effect.monoidEffect(Data_Monoid.monoidUnit)));
var alt = /* #__PURE__ */ Control_Alt.alt(Options_Applicative_Types.parserAlt);
var map3 = /* #__PURE__ */ Data_Functor.map(Options_Applicative_Types.parserFunctor);
var runParserInfo = /* #__PURE__ */ Options_Applicative_Common.runParserInfo(Options_Applicative_Internal.pMonadP);
var fromFoldable = /* #__PURE__ */ Data_List.fromFoldable(Data_Foldable.foldableArray);
var map4 = /* #__PURE__ */ Data_Functor.map(Effect.functorEffect);
var renderFailure = function (failure) {
    return function (progn) {
        var v = un(Options_Applicative_Types.ParserFailure)(failure)(progn);
        return new Data_Tuple.Tuple(Options_Applicative_Help_Types.renderHelp(v.value1.value1.value0)(v.value0), v.value1.value0);
    };
};
var parserFailure = function (pprefs) {
    return function (pinfo) {
        return function (msg) {
            return function (ctx) {
                var with_context = function (arr) {
                    return function (i) {
                        return function (f) {
                            var v = Data_Array.head(arr);
                            if (v instanceof Data_Maybe.Nothing) {
                                return f([  ])(i);
                            };
                            if (v instanceof Data_Maybe.Just) {
                                return Data_Exists.runExists(function (i$prime) {
                                    return f(Options_Applicative_Internal.contextNames(arr))(i$prime);
                                })(v.value0.value1);
                            };
                            throw new Error("Failed pattern match at Options.Applicative.Extra (line 183, column 28 - line 185, column 73): " + [ v.constructor.name ]);
                        };
                    };
                };
                var usage_help = function (progn) {
                    return function (names) {
                        return function (v) {
                            if (msg instanceof Options_Applicative_Types.InfoMsg) {
                                return mempty;
                            };
                            return Options_Applicative_Help_Core.usageHelp(Options_Applicative_Help_Chunk.vcatChunks([ pure(Options_Applicative_Help_Core.parserUsage(pprefs)(v.infoParser)(unWords(append([ progn ])(names)))), map(Text_PrettyPrint_Leijen.indent(2))(v.infoProgDesc) ]));
                        };
                    };
                };
                var suggestion_help = Options_Applicative_Help_Core.suggestionsHelp((function () {
                    if (msg instanceof Options_Applicative_Types.UnexpectedError) {
                        var opt_completions = function (v) {
                            return function (v1) {
                                if (v1.optMain instanceof Options_Applicative_Types.OptReader) {
                                    return map1(Options_Applicative_Common.showOption)(v1.optMain.value0);
                                };
                                if (v1.optMain instanceof Options_Applicative_Types.FlagReader) {
                                    return map1(Options_Applicative_Common.showOption)(v1.optMain.value0);
                                };
                                if (v1.optMain instanceof Options_Applicative_Types.ArgReader) {
                                    return [  ];
                                };
                                if (v1.optMain instanceof Options_Applicative_Types.CmdReader) {
                                    if (v.hinfoUnreachableArgs) {
                                        return [  ];
                                    };
                                    if (Data_Boolean.otherwise) {
                                        return v1.optMain.value1;
                                    };
                                };
                                throw new Error("Failed pattern match at Options.Applicative.Extra (line 273, column 64 - line 280, column 37): " + [ v1.optMain.constructor.name ]);
                            };
                        };
                        var possibles = fold(Data_Exists.runExists(function (zz) {
                            return Options_Applicative_Common.mapParser(opt_completions)(zz);
                        })(msg.value1.value0));
                        var isClose = function (a) {
                            return Data_Function.on(editDistance)(Data_String_CodeUnits.toCharArray)(a)(msg.value0) < 3;
                        };
                        var good = Data_Array.filter(isClose)(possibles);
                        var prose = (function () {
                            var $84 = Data_Array.length(good) < 2;
                            if ($84) {
                                return Options_Applicative_Help_Chunk.stringChunk("Did you mean this?");
                            };
                            return Options_Applicative_Help_Chunk.stringChunk("Did you mean one of these?");
                        })();
                        var suggestions = apply(map(Text_PrettyPrint_Leijen.appendWithLine)(prose))(map(Text_PrettyPrint_Leijen.indent(4))(Options_Applicative_Help_Chunk.vcatChunks(map1(Options_Applicative_Help_Chunk.stringChunk)(good))));
                        return suggestions;
                    };
                    return mempty1;
                })());
                var show_full_help = (function () {
                    if (msg instanceof Options_Applicative_Types.ShowHelpText) {
                        return true;
                    };
                    if (msg instanceof Options_Applicative_Types.MissingError && (msg.value0 instanceof Options_Applicative_Types.CmdStart && (un(Options_Applicative_Types.ParserPrefs)(pprefs)).prefShowHelpOnEmpty)) {
                        return true;
                    };
                    return (un(Options_Applicative_Types.ParserPrefs)(pprefs)).prefShowHelpOnError;
                })();
                var exit_code = (function () {
                    if (msg instanceof Options_Applicative_Types.ErrorMsg) {
                        return (un(Options_Applicative_Types.ParserInfo)(pinfo)).infoFailureCode;
                    };
                    if (msg instanceof Options_Applicative_Types.MissingError) {
                        return (un(Options_Applicative_Types.ParserInfo)(pinfo)).infoFailureCode;
                    };
                    if (msg instanceof Options_Applicative_Types.ExpectsArgError) {
                        return (un(Options_Applicative_Types.ParserInfo)(pinfo)).infoFailureCode;
                    };
                    if (msg instanceof Options_Applicative_Types.UnexpectedError) {
                        return (un(Options_Applicative_Types.ParserInfo)(pinfo)).infoFailureCode;
                    };
                    if (msg instanceof Options_Applicative_Types.ShowHelpText) {
                        return ExitCodes.Success.value;
                    };
                    if (msg instanceof Options_Applicative_Types.InfoMsg) {
                        return ExitCodes.Success.value;
                    };
                    throw new Error("Failed pattern match at Options.Applicative.Extra (line 171, column 17 - line 177, column 44): " + [ msg.constructor.name ]);
                })();
                var error_help = Options_Applicative_Help_Core.errorHelp((function () {
                    if (msg instanceof Options_Applicative_Types.ShowHelpText) {
                        return mempty1;
                    };
                    if (msg instanceof Options_Applicative_Types.ErrorMsg) {
                        return Options_Applicative_Help_Chunk.stringChunk(msg.value0);
                    };
                    if (msg instanceof Options_Applicative_Types.InfoMsg) {
                        return Options_Applicative_Help_Chunk.stringChunk(msg.value0);
                    };
                    if (msg instanceof Options_Applicative_Types.MissingError && (msg.value0 instanceof Options_Applicative_Types.CmdStart && (un(Options_Applicative_Types.ParserPrefs)(pprefs)).prefShowHelpOnEmpty)) {
                        return mempty1;
                    };
                    if (msg instanceof Options_Applicative_Types.MissingError) {
                        return Data_Exists.runExists(function (x) {
                            return Options_Applicative_Help_Chunk.chunkBeside(Options_Applicative_Help_Chunk.stringChunk("Missing:"))(Options_Applicative_Help_Core.missingDesc(pprefs)(x));
                        })(msg.value1.value0);
                    };
                    if (msg instanceof Options_Applicative_Types.ExpectsArgError) {
                        return Options_Applicative_Help_Chunk.stringChunk("The option `" + (msg.value0 + "` expects an argument."));
                    };
                    if (msg instanceof Options_Applicative_Types.UnexpectedError) {
                        var msg$prime = (function () {
                            var $108 = Options_Applicative_Internal_Utils.startsWith("-")(msg.value0);
                            if ($108) {
                                return "Invalid option `" + (msg.value0 + "'");
                            };
                            return "Invalid argument `" + (msg.value0 + "'");
                        })();
                        return Options_Applicative_Help_Chunk.stringChunk(msg$prime);
                    };
                    throw new Error("Failed pattern match at Options.Applicative.Extra (line 196, column 30 - line 225, column 30): " + [ msg.constructor.name ]);
                })());
                var base_help = function (v) {
                    var h = Options_Applicative_Help_Core.headerHelp(v.infoHeader);
                    var f = Options_Applicative_Help_Core.footerHelp(v.infoFooter);
                    if (show_full_help) {
                        return fold1([ h, f, Options_Applicative_Help_Core.parserHelp(pprefs)(v.infoParser) ]);
                    };
                    return mempty;
                };
                return function (progn) {
                    var h = with_context(ctx)(pinfo)(function (names) {
                        return function (pinfo$prime) {
                            return fold1([ base_help(pinfo$prime), usage_help(progn)(names)(pinfo$prime), suggestion_help, error_help ]);
                        };
                    });
                    return new Data_Tuple.Tuple(h, new Data_Tuple.Tuple(exit_code, new Data_Tuple.Tuple((un(Options_Applicative_Types.ParserPrefs)(pprefs)).prefColumns, Data_Unit.unit)));
                };
            };
        };
    };
};
var helper = /* #__PURE__ */ (function () {
    return Options_Applicative_Builder.abortOption(Options_Applicative_Types.ShowHelpText.value)(Data_Array.fold(Options_Applicative_Builder_Internal.modMonoid)([ Options_Applicative_Builder["long"](Options_Applicative_Builder_Internal.optionFieldsHasName)("help"), Options_Applicative_Builder["short"](Options_Applicative_Builder_Internal.optionFieldsHasName)("h"), Options_Applicative_Builder.help("Show this help text"), Options_Applicative_Builder.hidden ]));
})();
var hsubparser = function (m) {
    var v = append2(metavar("COMMAND"))(m);
    var v1 = Options_Applicative_Builder_Internal.mkCommand(m);
    var add_helper = over(Options_Applicative_Types.ParserInfo)(function (pinfo) {
        return {
            infoParser: apApplyFlipped(pinfo.infoParser)(helper),
            infoFailureCode: pinfo.infoFailureCode,
            infoFooter: pinfo.infoFooter,
            infoFullDesc: pinfo.infoFullDesc,
            infoHeader: pinfo.infoHeader,
            infoPolicy: pinfo.infoPolicy,
            infoProgDesc: pinfo.infoProgDesc
        };
    });
    var rdr = new Options_Applicative_Types.CmdReader(v1.value0, v1.value1.value0, (function () {
        var $146 = map2(add_helper);
        return function ($147) {
            return $146(v1.value1.value1.value0($147));
        };
    })());
    return Options_Applicative_Builder_Internal.mkParser(v.value1)(v.value2)(rdr);
};
var getProgName = /* #__PURE__ */ mapFlipped(Node_Process.argv)(function (args) {
    return Data_Maybe.fromMaybe("")(bind(Data_Array.index(args)(1))(function (executablePath) {
        return Data_Array.last(Data_String_Common.split("/")(executablePath));
    }));
});
var getParseResult = function (v) {
    if (v instanceof Options_Applicative_Types.Success) {
        return new Data_Maybe.Just(v.value0);
    };
    return Data_Maybe.Nothing.value;
};
var getArgs = /* #__PURE__ */ mapFlipped(Node_Process.argv)(/* #__PURE__ */ Data_Array.drop(2));
var exitWith = function (c) {
    return Node_Process.exit(fromEnum(c));
};
var exitSuccess = /* #__PURE__ */ (function () {
    return Node_Process.exit(fromEnum(ExitCodes.Success.value));
})();
var handleParseResult = function (v) {
    if (v instanceof Options_Applicative_Types.Success) {
        return pure1(v.value0);
    };
    if (v instanceof Options_Applicative_Types.Failure) {
        return function __do() {
            var progn = getProgName();
            var v1 = renderFailure(v.value0)(progn);
            var stream = (function () {
                if (v1.value1 instanceof ExitCodes.Success) {
                    return Node_Process.stdout;
                };
                return Node_Process.stderr;
            })();
            $$void(Node_Stream.writeString(stream)(Node_Encoding.UTF8.value)(v1.value0 + "\x0a")(mempty2))();
            return exitWith(v1.value1)();
        };
    };
    if (v instanceof Options_Applicative_Types.CompletionInvoked) {
        return function __do() {
            var progn = getProgName();
            var msg = (un(Options_Applicative_Types.CompletionResult)(v.value0)).execCompletion(progn)();
            $$void(Node_Stream.writeString(Node_Process.stdout)(Node_Encoding.UTF8.value)(msg)(mempty2))();
            return exitSuccess();
        };
    };
    throw new Error("Failed pattern match at Options.Applicative.Extra (line 110, column 1 - line 110, column 58): " + [ v.constructor.name ]);
};
var execParserPure = function (pprefs) {
    return function (pinfo) {
        return function (args) {
            var pinfo$prime = over(Options_Applicative_Types.ParserInfo)(function (i) {
                return {
                    infoParser: alt(map3(Data_Either.Left.create)(Options_Applicative_BashCompletion.bashCompletionParser(pinfo)(pprefs)))(map3(Data_Either.Right.create)(i.infoParser)),
                    infoFailureCode: i.infoFailureCode,
                    infoFooter: i.infoFooter,
                    infoFullDesc: i.infoFullDesc,
                    infoHeader: i.infoHeader,
                    infoPolicy: i.infoPolicy,
                    infoProgDesc: i.infoProgDesc
                };
            })(pinfo);
            var p = runParserInfo(pinfo$prime)(fromFoldable(args));
            var v = Options_Applicative_Internal.runP(p)(pprefs);
            if (v.value0 instanceof Data_Either.Right && v.value0.value0 instanceof Data_Either.Right) {
                return new Options_Applicative_Types.Success(v.value0.value0.value0);
            };
            if (v.value0 instanceof Data_Either.Right && v.value0.value0 instanceof Data_Either.Left) {
                return new Options_Applicative_Types.CompletionInvoked(v.value0.value0.value0);
            };
            if (v.value0 instanceof Data_Either.Left) {
                return new Options_Applicative_Types.Failure(parserFailure(pprefs)(pinfo)(v.value0.value0)(v.value1));
            };
            throw new Error("Failed pattern match at Options.Applicative.Extra (line 144, column 3 - line 147, column 73): " + [ v.constructor.name ]);
        };
    };
};
var customExecParser = function (pprefs) {
    return function (pinfo) {
        return bind1(map4(execParserPure(pprefs)(pinfo))(getArgs))(handleParseResult);
    };
};
var execParser = /* #__PURE__ */ customExecParser(Options_Applicative_Builder.defaultPrefs);
export {
    helper,
    hsubparser,
    execParser,
    customExecParser,
    execParserPure,
    getParseResult,
    handleParseResult,
    parserFailure,
    renderFailure
};
//# sourceMappingURL=index.js.map
